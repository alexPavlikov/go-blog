{{ define "guest" }}

{{ template "header" }}
<link rel="stylesheet" href="/assets/css/blog.css">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/community.css">
<link rel="stylesheet" href="/assets/css/friends.css">
<link rel="stylesheet" href="/assets/css/modal.css">
<link rel="stylesheet" href="/assets/css/page.css">

<header>
    <div class="brand">
        <div class="logos">
            <img src="/data/image/brand.png" alt="">
            <span>GOLANG</span>
        </div>
        <div class="find"><input type="text" placeholder="Найти"></div>
    </div>
    <div class="account">
        <div class="avatar"><img src="{{ .User.Photo }}" alt=""></div>
        <i class="fa-solid fa-chevron-down" onclick="Check()"></i>
    </div>
</header>

<script src='//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js'></script>

{{ if .Access }}

        <!-- Модальное окно -->    
        <input type="checkbox" id="css-modal-checkbox" />    
        <div class="cmc">
            <div class="cmt">
                <form action="/admin/banned" method="post">
                    <input type="text" id="user" name="user" value="{{ .Guest.Login }}" style="display: none;">
                    <input type="text" id="title" name="title"   placeholder="Укажите причину блокировки">
                    <input type="number" id="time" name="time" placeholder="Укажите время блокировки (часов)">
                    <button class="goBTN" type="submit">Заблокировать</button>
                </form>
            </div>
            <label for="css-modal-checkbox" class="css-modal-close"></label>
        </div>

    <div class="adm-menu">
        <div class="add">
            <label for="css-modal-checkbox" class="add">Забанить пользователя</label>
        </div>
        <div class="add">
            <form action="/admin/del" method="post">
                <input type="text" value="{{ .Guest.Login }}" name="Adm-guestId" id="Adm-guestId" style="display: none;">
                <input class="del-form" style="width: 100%; height: 100%;" type="submit" value="Удалить пользователя">
            </form>
        </div>
    </div>

{{ end }}


<input type="checkbox" id="css-modal-checkbox2" />    
<div class="cmc">
    <div class="cmt">
        <form action="help/complaint" method="get">
            <input type="text" id="guest" name="guest" value="{{ .Guest.Login }}" style="display: none;">
            <select name="selectComplaint" id="selectComplaint">
                <option style="display: none;" selected>Выберите причину жалобы</option>
                {{ range $_, $ct := .Complaint }}
                <option>{{ $ct }}</option>
                {{ end }}
            </select>
            <input type="submit" value="Отправить">
        </form>
    </div>
    <label for="css-modal-checkbox2" class="css-modal-close"></label>
</div>

<body>
    <aside class="right">
        <a href="/page#"><i class="fa-regular fa-circle-user"></i><span> Моя страница</span></a>
        <a href="/blog"><i class="fa-regular fa-newspaper"></i><span> Новости</span></a>
        <a href="/message"><i class="fa-regular fa-comment"></i><span> Сообщения</span></a>
        <a href="/friends"><i class="fa-solid fa-user-group"></i><span> Друзья</span></a>
        <a href="/communities"><i class="fa-solid fa-users"></i><span> Сообщества</span></a>
        <a href="/setting"><i class="fa-solid fa-gear"></i> <span> Настройки</span></a>
        <a href="#"><i class="fa-solid fa-circle-half-stroke"></i> <span> Тема</span</a>
        <a href="/help"><i class="fa-regular fa-circle-question"></i> <span> Помощь</span</a>
        <a href="/store"><i class="fa-brands fa-golang"></i><span> Go-Store</span></a>
    </aside>

        <!-- Модальное окно -->    
        <input type="checkbox" id="css-modal-checkbox" />    
        <div class="cmc">
            <div class="cmt-gopher cmt cmt-gopher" style="background: url(/data/image/brand.png);background-size: no-repeat;
            background-position: center;
            background-size: 50%;
            background-size: cover;">
                <form action="page/post" id="form2" name="formImg" method="post">

                    <input name="title" id="title" type="text" placeholder="Заголовок гофера">
                    <textarea name="content" id="content" cols="30" rows="10" placeholder="Содержание гофера"></textarea>
                    <button id="{{ .Guest.Login }}" class="goBTN" type="submit">GO</button>
                </form>
            </div>
            <label for="css-modal-checkbox" class="css-modal-close"></label>
        </div>

    <main>

        <section>

            <div class="photo">
                <img src="{{ .Guest.Photo }}" alt="">
                <div class="name">{{ .Guest.Name }}</div>
                {{ if .OK }}
                <div id="{{ .Guest.Login }}" class="go-friend">Отправить заявку в друзья</div>
                {{ end }}
            </div>
            <div class="com_stat">               
                <div class="txt">Дата рождения: <span>{{ .Statistics.HappyBithday }}</span></div>
                <div class="txt">Сообществ <a class="guestId" href="/guest/communities">{{ .Statistics.CommunitiesLen }}</a></div>
                <div class="txt">Друзей <a class="guestId" href="/guest/friends">{{ .Statistics.FrinedsLen }}</a></div>
            </div>

        </section>

        <div class="adds">
            <label for="css-modal-checkbox2" class="add del"><i class="fa-solid fa-person-circle-exclamation"></i> Пожаловаться</label>
        </div>

        {{ if .Friend }}    
       
        {{ else }}
            <div class="adds">
                <label for="css-modal-checkbox" class="add-rev add add-com"><i class="fa-solid fa-circle-plus"></i> Написть гофер</label>
            </div>
        {{ end }}

        <div class="friends">
            <div class="tabs">
                <input type="radio" name="tab-btn" id="tab-btn-1" value="" checked>
                <label for="tab-btn-1">Гоферы</label>
                <input type="radio" name="tab-btn" id="tab-btn-2" value="">
                <label for="tab-btn-2">Репосты</label> 

                <div id="content-1">
                    <div class="news">
                        {{ if .DoneGopher }}
                            {{ range $_, $g := .Gopher }}
                            <div class="post gopher" id="{{$g.Id}}">
                                <div class="communities communities-gopher">
                                    <div class="avatar"><img src="{{ $g.CreatorPhoto }}" alt=""></div>
                                    <div class="name">
                                        <div>{{ $g.CreatorName }} <span><a style="text-decoration: none; color: black;" href="/guest#{{$g.Id}}">{{ $g.Title }}</a></span></div>
                                        <label>{{ $g.Date }}</label>
                                    </div>
                                </div>
                                <div class="title gopher-content">{{ $g.Content }}</div>
                                <div class="statistics gopher-stat">
                                    <div>
                                        <a href="guest" id="{{$g.Id}}"  class="spans goLike" style="color: #fff; text-decoration: none;"><i style="margin-right: 5px;" class="fa-regular fa-heart"></i>{{$g.Like}}</a>     
                                        <a href="/page/rep_gof" id="{{$g.Id}}" class="spans gof"><i class="fa-regular fa-paper-plane"></i></a> 
                                    </div>
                                    
                                    <i class="fa-solid fa-eye">{{$g.View}}</i>
                                </div>
                            </div>
                            {{ end }}
                        {{else}}
                            <h2 class="subtitles" style="width: 100%; color: rgba(60, 161, 255);">На стене пока нет ни одного гофера</h2>
                        {{ end }}
                    </div>
                </div>
                <div id="content-2">
                    <div class="news">
                        {{ if .Done }}
                            {{ range $_, $r := .Repo }}
                            <div class="post" id="{{$r.Post}}">
                                <div class="communities">
                                    <div class="avatar"><img src="{{ $r.CommunitiesPhoto }}" alt=""></div>
                                    <div class="name">
                                        <div>{{ $r.Communities }} <span><a style="text-decoration: none; color: black;" href="/blog#{{$r.Post}}">{{ $r.Title }}</a></span></div>
                                        <label>{{ $r.Date }}</label>
                                    </div>
                                </div>
                                <div class="title">{{ $r.Content }}</div>
                                <div class="image"><img src="{{ $r.PostPhoto }}" alt=""></div>
                                <div class="statistics">
                                    <div>
                                        <a href="blog" id="{{$r.Post}}"  class="spans span spany" style="color: #fff; text-decoration: none;"><i style="margin-right: 5px;" class="fa-regular fa-heart"></i>{{$r.Like}}</a>
                                        <a href="comments"  id="{{$r.Post}}" class="spans span spany" type="submit"><i class="fa-regular fa-message"></i></a>     
                                        <a href="/page/rep_gof" id="{{$r.Post}}" class="spans gof2"><i class="fa-regular fa-paper-plane"></i></a> 
                                    </div>
                                    
                                    <i class="fa-solid fa-eye">{{$r.View}}</i>
                                </div>
                            </div>
                            {{ end }}
                        {{else}}
                            <h2 style="width: 100%; color: rgba(60, 161, 255);" class="subtitles">На стене пока нет ни одной записи</h2>
                        {{ end }}
                    </div>
                </div>
            </div>
        </div>

    </main>
    <aside id="left" class="left">
        <div class="setacc">
            <div class="avatar"><img src="{{ .User.Photo }}" alt=""></div>
            <div class="info">
                <div class="name">{{ .User.Name }}</div>
                <div class="login">{{ .User.Login }}</div>
            </div>
        </div>
        <div class="settings">
            <a href="/setting"><i class="fa-solid fa-gear"></i> <span> Настройки</span></a>
            <a href="/favourites"><i class="fa-solid fa-bookmark"></i> <span> Избранное</span></a>
            <a href="#"><i class="fa-solid fa-circle-half-stroke"></i> <span> Тема</span></a>
            <a href="/help"><i class="fa-regular fa-circle-question"></i> <span> Помощь</span></a>
            <a id="exit" href="/exit"><i class="fa-solid fa-arrow-right-from-bracket"></i> <span> Выйти</span></a>
        </div>
    </aside>
</body>

<script>

        $(document).ready(function(){
                    $('.goLike').click(function(e) {
                        clickId = $(this).attr('id');
                            $.ajax({
                                url: '/page',
                                type: 'POST',
                                dataType: 'html',
                                data : { goLike: clickId},
                                success : function(data) {
                                $('#result').html(data);
                                },
                            });
            });
        });

      $(document).ready(function(){
            $('.guestId').click(function(e) {
                clickId = $(this).attr('id');
                    $.ajax({
                        url: '/guest',
                        type: 'GET',
                        dataType: 'html',
                        data : { guestLogin: clickId},
                        success : function(data) {
                        $('#result').html(data);
                        },
                    });
                alert(guestLogin);
            });
        });

        $(document).ready(function(){
            $('.go-friend').click(function(e) {
                var button = $(this);
                clickId = $(this).attr('id');
                    $.ajax({
                        url: '/friends/rec',
                        type: 'POST',
                        dataType: 'html',
                        data : { friend_id: clickId},
                        success : function(data) {
                        $('#result').html(data);
                        },
                    });
                    button.addClass('check');
            });
        });

        $(document).ready(function(){
            $('.gof').click(function(e) {
                clickId = $(this).attr('id');
                    $.ajax({
                        url: '/page/rep_gof',
                        type: 'POST',
                        dataType: 'html',
                        data : { gof: clickId},
                        success : function(data) {
                        $('#result').html(data);
                        },
                    });
            });
        });

        $(document).ready(function(){
            $('.gof2').click(function(e) {
                clickId = $(this).attr('id');
                    $.ajax({
                        url: '/page/rep_gof',
                        type: 'GET',
                        dataType: 'html',
                        data : { gof2: clickId},
                        success : function(data) {
                        $('#result').html(data);
                        },
                    });
            });
        });

</script>

{{ template "footer" }}

{{ end }}
